## Automatic repair experiment on QuixBugs.

This experiment is to evaluate effectiveness of two representative automatic repair tools Astor and Nopol on repairing [QuixBugs](https://github.com/jkoppel/QuixBugs) benchmark. QuixBugs is a benchmark suite of 40 confirmed bugs from classic algorithms with a bug on a single line of code. Before we start our experiment, we did some [preperation work](https://github.com/jkoppel/QuixBugs/pulls?q=is%3Apr+is%3Aclosed) to contribute QuixBugs as a usable repair benchmark in Java programs.

In our experiment, we focus on two parts:

A: How many QuixBugs programs could be repaired by two considered tools?

B: How to assess the correctness of generated patches?




### Project Structure

[Buggy Java Programs](https://github.com/KTH/quixbugs-experiment/tree/master/src/main/java/buggy_java_programs) are 40 buggy programs from QuixBugs and Corresponding [Junit Tests](https://github.com/KTH/quixbugs-experiment/tree/master/src/test/java/buggy_java_programs)

[Reference Programs](https://github.com/KTH/quixbugs-experiment/tree/master/src/main/java/java_programs) are the ground truth version based on the provided correct Python version from QuixBugs.

[Patches](https://github.com/KTH/quixbugs-experiment/tree/master/patches) contains all patches generated by Astor and Nopol.

[Evosuite Tests and InputSampling Tests](https://github.com/KTH/quixbugs-experiment/tree/master/generatedTests) are the independent tests generated based reference programs, to assess patches generated by Astor and Nopol. 

[Patch Correctness Assessment](https://github.com/KTH/quixbugs-experiment/tree/master/patches_assessment_report) are the assessment reports of each patch when runing different number tests.

### Getting started

#### Check out the project:

```
git clone https://github.com/KTH/quixbugs-experiment.git
cd quixbugs-experiment
mvn clean install -DskipTests
cd ..
```

##### Class to generate tests by InputSampling
```
simpletest.generator.InputSampling
```


##### Class to generate tests by Evosuite

```
simpletest.generator.QuixBugExtendedOracle

```

##### Patch correctness assessment:

To assess patches ,for example, by using 30 Evosuite test suites:

```
java -cp /path/to/junit-4.9.jar org.junit.runner.JUnitCore qfevotest.generator.PatchAssessmentTest#testResultsByRunning30Seeds

```
To assess patches ,for example, by using 300 InputSampling tests:

```
java -cp /path/to/junit-4.9.jar org.junit.runner.JUnitCore qfevotest.generator.PatchAssessmentTest#inputSampling_300_assessment
```


### QuixBugExtendedOracle

The class QuixBugExtendedOracle runs EvosuiteTest generation for generating test cases, and runs a patched version of a program over it.

### preconditions

| program | preconditions|
| --- |---|
|depth_first_search||
|find_in_sorted|a sorted list of ints|
|get_factors|n int greater than 1|
|is_valid_parenthesization|paren in '()'|
|knapsack||
|levenshtein||
|lis|the ints in arr are unique|
|mergesort||
|next_permutation|perm is not sorted in reverse order|
|powerset|array has no duplicate elements|
|quicksort|the ints in arr are unique|
|rpn_eval|token in ('+', '-', '*', '/')|

### Failing evosuite

| program | failing tests in seed|reason|solution|
| --- |---| --- |---|
| flatten |seed2(Test 2)|illegal paramters|remove|
|hanoi | seed1(Test0/1/2)  |Timeout/Compilation errors |increase timeout /add uncheck annotation for each method|
|knapsack|seed2(Test4) seed8(Test5)|ArrayIndexOutOfBoundsException(Undeclared exception)|remove|
|levenshtein|seed3(Test4) seed5(Test1) seed6(Test2) seed7(Test2) seed9(Test3) seed10(Test2) seed11(Test0/2) seed14(Test0/1/5/6) seed15(Test2) seed17(Test3) seed18(Test4) seed19(Test3) seed20(Test1)|recursion error|remove|
|longest_common_subsequence|seed1(Test6) seed2(Test0) seed11（Test7)seed12(Test1) seed13(Test3)seed14(Test4)seed16(Test0/6）|timeout|remove timeout|
|possible_change|seed1(Test2/4/5/6) seed5(Test3/4/6/7) seed7(Test0/2/6) seed13(Test0/1/4/5) seed16(Test3/4/5) seed19(Test1/4/5) seed20(0/2/3)|illegal paramters(recursion)|remove|
|sqrt|seed1(Test1) seed2(Test2) seed3(Test2）seed4(Test2) seed5(Test1) seed6(Test2)seed7(Test2) seed8/9/10(Test1) seed13/14(Test2) seed15(Test1) seed17(Test2) seed18(Test1) seed19(Test2) seed20(Test1)|illegal paramters(recursion)|remove|
|subsequences|seed1(Test1/2/3/4/5/10) seed2(0/2/3/5/6/7) seed6(Test0/1/2/3/5/6) seed9(Test0/1/2) seed11(Test1/2/3/5/6) seed12(Test1/3/4) seed13(Test1/2/4/5/6)|illegal paramters(recursion)|remove|
|to_base|seed1(Test4) seed2(Test4) seed3(Test3) seed4(Test3) seed5(Test1) seed6(Test4) seed7(Test1) seed8(Test4) seed9(Test4) seed10(Test1) seed11(Test4) seed12(Test4) seed13(Test1) seed14(Test4) seed15(Test4) seed16(Test4) seed17(Test1) seed18(Test4) seed19(Test4) seed20(Test3)|illegal paramters(recursion)|remove|
|wrap|seed1(Test5) seed2(Test2) seed3(Test2) seed4(Test4) seed5(Test2) seed6(Test3) seed7(Test3) seed8(Test2) seed9(Test2) seed10(Test4) seed11(Test4) seed12(Test4) seed13(Test4) seed14(Test4) seed15(Test4) seed16(Test4) seed17(Test4)seed18(Test3) seed19(Test3)seed20(Test6)|illegal paramters(recursion)|remove|
|pascal|seed8(Test2) seed14(Test1)|illegal paramters(recursion)|remove|




